# 비밀번호 시스템을 "제대로" 만드는 방법

- '잘못된 방법'과 '좋은 방법'을 통해 알아보자

## 잘못된 방법

### Database에 password가 그대로 넣은 경우

- Database에서 password가 그대로 보인다면 좋은 방법이 아님
- 어드민이건 그냥 직원들이건 다 볼 수 있는 상황..

### 비밀번호를 암호화시키는 경우

- 어떤 회사에서는 비밀번호를 암호화시킴
- 유저는 회사에서 주는 key와 함께 로그인함
- 암호를 key로 해제하고 비밀번호가 맞으면 로그인 성공
- 다하고나면 다시 비번을 암호화시킴
- 첫번째 방법보다는 훨씬 괜찮음
- 하지만 누군가가 key를 훔치면, 모든 비번을 다 볼 수 있음
- 그래서 이 방법도 유저에게 좋은 방법은 아님

### hash 함수를 사용하는 법

- hash함수는 입력한 값을 요상한 값으로 둔갑시켜줌
- hash함수에 대해 알아야할 3가지
  - 첫번째, hash함수는 동일한 입력값(input)에 대한 동일한 출력값(output)을 갖고 있음
    - 즉, 입력값이 바뀌지 않으면, 출력값도 바뀌지 않음
  - 두번째, 입력값이 아주 살짝, 약간 변경되어도 이에 대한 출력값은 어마어마하게 바뀜
  - 세번째, 이 함수는 항상 같은 방향, 일방향으로만 움직임
- 유저가 준 패스워드를 해시함수로 변형해서 바뀐 값을 데이터베이스에 넣음
- 이제 어드민이나 직원들이 데이터베이스의 비번을 봐도 무엇인지 알 수가 없음
- 여기서 문제는 "레인보우 테이블"이라는 것이 있다는 것
  - 일반적으로 해쉬값을 보면 암호화가 되어서 비번을 알 수 없지만, 이 값을 "레인보우 테이블"에서 찾아보면..
  - 레인보우 테이블이란 이런 해쉬값들을 입력값이랑 연결해놓은 테이블임
  - 해커는 병형된 해쉬값(출력값)을 레인보우 테이블에 돌려보고 입력값, 즉, 비밀번호를 찾을 수 있게 됨
- 이러한 것들 때문에 "Salt"라는 것이 생겼음

## 좋은 방법

### Salt를 사용하는 방법

- Salt는 아주 조그만, 랜덤 텍스트인데, 나중에 유저가 계정을 만들게 되면, 유저의 비밀번호와 이 Salt를 함께 해쉬함수에 돌림
- 그러면 아주 랜덤한 결과값으로 이어지고, 그걸 데이터베이스에 저장하게 됨
- 이제 해쉬값을 레인보우테이블에서 찾아봐도 없음, 입력값을 Salt와 함께 해쉬했으니까
- 이 방법을 쓴다면, 데이터베이스의 비밀번호를 노리는 해커로부터 보호할 수 있고, 레인보우 테이블을 가지고 있는 해커로부터도 보호할 수 있음

