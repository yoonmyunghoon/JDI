# 가비지 컬렉터란? (Feat. 메모리 관리)

- 코드에 작성하는 변수, 함수, 객체들이 메모리의 공간을 차지하는 요소들임
- C나 C++같은 오래된 언어에서는 중간중간에 일일이 메모리 공간을 만들어줘야했음
- 아무리 신중한 프로그래머라도 비워주어야할 메모리 공간을 그대로 남겨두는 경우가 생김
- 이걸 메모리 누수, memory leak이라고 함
- 이렇게 계속 메모리 누수가 발생하다가 메모리를 꽉 채우게 되면 컴퓨터가 뻗게 됨
- 그래서 자바를 비롯한 새로운 언어들에서는 가비지 컬렉터를 도입함
- 이렇게 메모리를 알아서 관리하는 언어들을 managed language라고 함
  - 반대는 unmanaged language
- 언어와 동작하는 환경마다 다르지만 특정 때에 특정 방식으로 필요없는 정보들, garbage들을 쓸어담아 버림
- 가비지 컬렉터가 일하는 방식에는 여러가지가 있음
  - Mark-and-sweep
    - 쭉 훑으면서 아직 필요한 것들만 마크한 다음에 마크가 안된 것들을 갖다버리는 방법
    - 프로그래밍 관점에서는 루트에 닿지 않는 변수들을 치우는 것
  - Reference counting
    - 한 요소가 다른 요소에게 몇 번 참조가 되는지 세어서 그 수가 0이 되면 치우는 것
- 예전에는 가비지 컬렉터가 돌때 컴퓨터가 잠시 얼었지만 현재는 많이 스마트해져서 멀티스레드로 돌면서 주워감
- 그럼에도 가비지 컬렉터에는 한계가 있음
  - 사람의 판단력을 갖춘게 아니기 때문에 지워야 할 것들을 100퍼센트 잡아내진 못함
  - 그러니까 managed language를 쓴다고해서 메모리 관리를 그냥 가비지 컬렉터에게 전적으로 맡기면 안됨
- 좋은 프로그래머가 되려면 메모리 관리에도 신경을 써야됨
- 메모리 누수를 방지하는 방식은 어느정도 공통적인 것도 있지만 뭘 프로그래밍하느냐에 따라 다른 부분들도 있음
- 언어나 환경마다 특성이 다르기 때문에 모든 환경에서 적용되는 것은 아니지만 보편적인 것들이 있음
  - 순환참조 하지 말 것
    - 변수들이 서로 참조해버리면 레퍼런스 카운팅이 0이 안됨
- 언어나 환경마다 메모리 누수를 잡아내기 위한 방법들이 있고 디버깅, 모니터링 툴들이 있음
- 이것들을 잘 활용해서 누수를 찾아내고 막으면 됨
- 구글링 키워드 예시
  - 자바스크립트 메모리 누수 사례
  - 안드로이드에서 메모리 릭 잡기
  - 파이썬의 가비지 컬렉터는 어떻게 동작하는가
    - 레퍼런스 카운트와 가비지 콜렉션에 의해 관리됨
    - sys.getrefcount()로 체크